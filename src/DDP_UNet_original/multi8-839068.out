Distributed computation initialized
Distributed computation initialized
2020-07-22 21:28:32,214 - root - INFO - rank 6, begin data loader init
2020-07-22 21:28:32,214 - root - INFO - rank 1, begin data loader init
Distributed computation initialized
2020-07-22 21:28:32,215 - root - INFO - rank 2, begin data loader init
Distributed computation initialized
2020-07-22 21:28:32,215 - root - INFO - rank 4, begin data loader init
Distributed computation initialized
2020-07-22 21:28:33,219 - root - INFO - rank 7, begin data loader init
Distributed computation initialized
2020-07-22 21:28:33,220 - root - INFO - rank 3, begin data loader init
Distributed computation initialized
2020-07-22 21:28:33,221 - root - INFO - rank 5, begin data loader init
Distributed computation initialized
2020-07-22 21:28:33,228 - root - INFO - ------------------ Configuration ------------------
2020-07-22 21:28:33,228 - root - INFO - Configuration file: /global/cfs/cdirs/dasrepo/tkurth/DataScience/cosmo-3D/src/DDP_UNet_original/config/UNet.yaml
2020-07-22 21:28:33,229 - root - INFO - Configuration name: multi8
2020-07-22 21:28:33,233 - root - INFO - ngpu 8
2020-07-22 21:28:33,233 - root - INFO - weight_init ordereddict([('conv_init', 'normal'), ('conv_scale', 0.02), ('conv_bias', 0.0)])
2020-07-22 21:28:33,233 - root - INFO - lr 0.0001
2020-07-22 21:28:33,233 - root - INFO - data_path /data/DDP_trdat.h5
2020-07-22 21:28:33,233 - root - INFO - num_epochs 5
2020-07-22 21:28:33,233 - root - INFO - num_data_workers 2
2020-07-22 21:28:33,233 - root - INFO - LAMBDA_2 0.01
2020-07-22 21:28:33,233 - root - INFO - data_size 256
2020-07-22 21:28:33,233 - root - INFO - N_out_channels 5
2020-07-22 21:28:33,233 - root - INFO - batch_size 1
2020-07-22 21:28:33,233 - root - INFO - ---------------------------------------------------
2020-07-22 21:28:33,233 - root - INFO - rank 0, begin data loader init
2020-07-22 21:34:31,286 - root - INFO - rank 3, data loader initialized
2020-07-22 21:34:31,291 - root - INFO - rank 6, data loader initialized
2020-07-22 21:34:31,744 - root - INFO - rank 2, data loader initialized
2020-07-22 21:34:31,792 - root - INFO - rank 1, data loader initialized
2020-07-22 21:34:31,887 - root - INFO - rank 7, data loader initialized
2020-07-22 21:34:32,111 - root - INFO - rank 0, data loader initialized
2020-07-22 21:34:33,008 - root - INFO - rank 4, data loader initialized
2020-07-22 21:34:34,058 - root - INFO - rank 5, data loader initialized
2020-07-22 21:34:39,601 - root - INFO - Loading checkpoint /global/cfs/cdirs/dasrepo/tkurth/DataScience/cosmo-3D/src/DDP_UNet_original/expts/multi8/14/training_checkpoints/ckpt.tar
2020-07-22 21:34:41,214 - root - INFO - DistributedDataParallel(
  (module): UNet(
    (conv_down1): Sequential(
      (0): Conv3d(4, 64, kernel_size=(4, 4, 4), stride=(2, 2, 2), padding=(1, 1, 1))
      (1): LeakyReLU(negative_slope=0.01, inplace=True)
    )
    (conv_down2): Sequential(
      (0): Conv3d(64, 128, kernel_size=(4, 4, 4), stride=(2, 2, 2), padding=(1, 1, 1))
      (1): LeakyReLU(negative_slope=0.01, inplace=True)
    )
    (conv_down3): Sequential(
      (0): Conv3d(128, 256, kernel_size=(4, 4, 4), stride=(2, 2, 2), padding=(1, 1, 1))
      (1): LeakyReLU(negative_slope=0.01, inplace=True)
    )
    (conv_down4): Sequential(
      (0): Conv3d(256, 512, kernel_size=(4, 4, 4), stride=(2, 2, 2), padding=(1, 1, 1))
      (1): LeakyReLU(negative_slope=0.01, inplace=True)
    )
    (conv_down5): Sequential(
      (0): Conv3d(512, 512, kernel_size=(4, 4, 4), stride=(2, 2, 2), padding=(1, 1, 1))
      (1): LeakyReLU(negative_slope=0.01, inplace=True)
    )
    (conv_down6): Sequential(
      (0): Conv3d(512, 512, kernel_size=(4, 4, 4), stride=(2, 2, 2), padding=(1, 1, 1))
      (1): LeakyReLU(negative_slope=0.01, inplace=True)
    )
    (conv_up6): Sequential(
      (0): ConvTranspose3d(512, 512, kernel_size=(4, 4, 4), stride=(2, 2, 2), padding=(1, 1, 1))
      (1): ReLU(inplace=True)
    )
    (conv_up5): Sequential(
      (0): ConvTranspose3d(1024, 512, kernel_size=(4, 4, 4), stride=(2, 2, 2), padding=(1, 1, 1))
      (1): ReLU(inplace=True)
    )
    (conv_up4): Sequential(
      (0): ConvTranspose3d(1024, 256, kernel_size=(4, 4, 4), stride=(2, 2, 2), padding=(1, 1, 1))
      (1): ReLU(inplace=True)
    )
    (conv_up3): Sequential(
      (0): ConvTranspose3d(512, 128, kernel_size=(4, 4, 4), stride=(2, 2, 2), padding=(1, 1, 1))
      (1): ReLU(inplace=True)
    )
    (conv_up2): Sequential(
      (0): ConvTranspose3d(256, 64, kernel_size=(4, 4, 4), stride=(2, 2, 2), padding=(1, 1, 1))
      (1): ReLU(inplace=True)
    )
    (conv_last): ConvTranspose3d(128, 5, kernel_size=(4, 4, 4), stride=(2, 2, 2), padding=(1, 1, 1))
  )
)
2020-07-22 21:34:41,216 - root - INFO - Starting Training Loop...
/global/cfs/cdirs/dasrepo/tkurth/DataScience/cosmo-3D/src/DDP_UNet_original/utils/plotting.py:49: RuntimeWarning: divide by zero encountered in true_divide
  (prediction - tar), prediction, (prediction - tar)/tar]
2020-07-22 21:40:52,176 - root - INFO - Time taken for epoch 5 is 370.96014952659607 sec
2020-07-22 21:40:52,176 - root - INFO - train step time=137.67961764335632 (20 steps), logging time=99.44108271598816
2020-07-22 21:40:52,176 - root - INFO - train samples/sec = 0.14526478459438905
2020-07-22 21:42:48,882 - root - INFO - Time taken for epoch 6 is 116.70527839660645 sec
2020-07-22 21:42:48,882 - root - INFO - train step time=13.00796103477478 (20 steps), logging time=74.748850107193
2020-07-22 21:42:48,882 - root - INFO - train samples/sec = 1.5375199807666307
2020-07-22 21:44:46,266 - root - INFO - Time taken for epoch 7 is 117.3843195438385 sec
2020-07-22 21:44:46,266 - root - INFO - train step time=22.4640474319458 (20 steps), logging time=83.3431384563446
2020-07-22 21:44:46,267 - root - INFO - train samples/sec = 0.8903115104519538
2020-07-22 21:46:39,724 - root - INFO - Time taken for epoch 8 is 113.45699095726013 sec
2020-07-22 21:46:39,724 - root - INFO - train step time=9.970674991607666 (20 steps), logging time=81.39783000946045
2020-07-22 21:46:39,724 - root - INFO - train samples/sec = 2.0058822513855916
2020-07-22 21:47:16,544 - root - INFO - DONE ---- rank 3
2020-07-22 21:47:16,575 - root - INFO - DONE ---- rank 5
2020-07-22 21:47:16,709 - root - INFO - DONE ---- rank 2
2020-07-22 21:47:16,767 - root - INFO - DONE ---- rank 6
2020-07-22 21:47:16,888 - root - INFO - DONE ---- rank 4
2020-07-22 21:47:17,194 - root - INFO - DONE ---- rank 7
2020-07-22 21:47:17,305 - root - INFO - DONE ---- rank 1
2020-07-22 21:48:26,563 - root - INFO - Time taken for epoch 9 is 106.83941435813904 sec
2020-07-22 21:48:26,564 - root - INFO - train step time=15.978605508804321 (20 steps), logging time=74.9184992313385
2020-07-22 21:48:26,564 - root - INFO - train samples/sec = 1.251673682598889
2020-07-22 21:48:30,099 - root - INFO - DONE ---- rank 0
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
Wed Jul 22 14:48:32 PDT 2020
